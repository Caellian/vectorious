var Yt=Object.create;var mr=Object.defineProperty;var Zt=Object.getOwnPropertyDescriptor;var Xt=Object.getOwnPropertyNames;var Kt=Object.getPrototypeOf,Qt=Object.prototype.hasOwnProperty;var H=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var J=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var re=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Xt(t))!Qt.call(r,a)&&a!==e&&mr(r,a,{get:()=>t[a],enumerable:!(o=Zt(t,a))||o.enumerable});return r};var te=(r,t,e)=>(e=r!=null?Yt(Kt(r)):{},re(t||!r||!r.__esModule?mr(e,"default",{value:r,enumerable:!0}):e,r));var $t=J((Lm,Ut)=>{Ut.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}});var Ct=J((Im,Q)=>{typeof Object.create=="function"?Q.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:Q.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}});var Ht=J(h=>{var Xo=/%[sdj%]/g;h.format=function(r){if(!B(r)){for(var t=[],e=0;e<arguments.length;e++)t.push(w(arguments[e]));return t.join(" ")}for(var e=1,o=arguments,a=o.length,n=String(r).replace(Xo,function(m){if(m==="%%")return"%";if(e>=a)return m;switch(m){case"%s":return String(o[e++]);case"%d":return Number(o[e++]);case"%j":try{return JSON.stringify(o[e++])}catch{return"[Circular]"}default:return m}}),s=o[e];e<a;s=o[++e])P(s)||!E(s)?n+=" "+s:n+=" "+w(s);return n};h.deprecate=function(r,t){if(x(global.process))return function(){return h.deprecate(r,t).apply(this,arguments)};if(process.noDeprecation===!0)return r;var e=!1;function o(){if(!e){if(process.throwDeprecation)throw new Error(t);process.traceDeprecation?console.trace(t):console.error(t),e=!0}return r.apply(this,arguments)}return o};var F={},rr;h.debuglog=function(r){if(x(rr)&&(rr=process.env.NODE_DEBUG||""),r=r.toUpperCase(),!F[r])if(new RegExp("\\b"+r+"\\b","i").test(rr)){var t=process.pid;F[r]=function(){var e=h.format.apply(h,arguments);console.error("%s %d: %s",r,t,e)}}else F[r]=function(){};return F[r]};function w(r,t){var e={seen:[],stylize:Qo};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),ar(t)?e.showHidden=t:t&&h._extend(e,t),x(e.showHidden)&&(e.showHidden=!1),x(e.depth)&&(e.depth=2),x(e.colors)&&(e.colors=!1),x(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=Ko),R(e,r,e.depth)}h.inspect=w;w.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};w.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Ko(r,t){var e=w.styles[t];return e?"\x1B["+w.colors[e][0]+"m"+r+"\x1B["+w.colors[e][1]+"m":r}function Qo(r,t){return r}function rn(r){var t={};return r.forEach(function(e,o){t[e]=!0}),t}function R(r,t,e){if(r.customInspect&&t&&C(t.inspect)&&t.inspect!==h.inspect&&!(t.constructor&&t.constructor.prototype===t)){var o=t.inspect(e,r);return B(o)||(o=R(r,o,e)),o}var a=tn(r,t);if(a)return a;var n=Object.keys(t),s=rn(n);if(r.showHidden&&(n=Object.getOwnPropertyNames(t)),$(t)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return tr(t);if(n.length===0){if(C(t)){var m=t.name?": "+t.name:"";return r.stylize("[Function"+m+"]","special")}if(U(t))return r.stylize(RegExp.prototype.toString.call(t),"regexp");if(nr(t))return r.stylize(Date.prototype.toString.call(t),"date");if($(t))return tr(t)}var f="",c=!1,y=["{","}"];if(Rt(t)&&(c=!0,y=["[","]"]),C(t)){var u=t.name?": "+t.name:"";f=" [Function"+u+"]"}if(U(t)&&(f=" "+RegExp.prototype.toString.call(t)),nr(t)&&(f=" "+Date.prototype.toUTCString.call(t)),$(t)&&(f=" "+tr(t)),n.length===0&&(!c||t.length==0))return y[0]+f+y[1];if(e<0)return U(t)?r.stylize(RegExp.prototype.toString.call(t),"regexp"):r.stylize("[Object]","special");r.seen.push(t);var l;return c?l=en(r,t,e,s,n):l=n.map(function(d){return or(r,t,e,s,d,c)}),r.seen.pop(),on(l,f,y)}function tn(r,t){if(x(t))return r.stylize("undefined","undefined");if(B(t)){var e="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(e,"string")}if(Pt(t))return r.stylize(""+t,"number");if(ar(t))return r.stylize(""+t,"boolean");if(P(t))return r.stylize("null","null")}function tr(r){return"["+Error.prototype.toString.call(r)+"]"}function en(r,t,e,o,a){for(var n=[],s=0,m=t.length;s<m;++s)Bt(t,String(s))?n.push(or(r,t,e,o,String(s),!0)):n.push("");return a.forEach(function(f){f.match(/^\d+$/)||n.push(or(r,t,e,o,f,!0))}),n}function or(r,t,e,o,a,n){var s,m,f;if(f=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]},f.get?f.set?m=r.stylize("[Getter/Setter]","special"):m=r.stylize("[Getter]","special"):f.set&&(m=r.stylize("[Setter]","special")),Bt(o,a)||(s="["+a+"]"),m||(r.seen.indexOf(f.value)<0?(P(e)?m=R(r,f.value,null):m=R(r,f.value,e-1),m.indexOf(`
`)>-1&&(n?m=m.split(`
`).map(function(c){return"  "+c}).join(`
`).substr(2):m=`
`+m.split(`
`).map(function(c){return"   "+c}).join(`
`))):m=r.stylize("[Circular]","special")),x(s)){if(n&&a.match(/^\d+$/))return m;s=JSON.stringify(""+a),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=r.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=r.stylize(s,"string"))}return s+": "+m}function on(r,t,e){var o=0,a=r.reduce(function(n,s){return o++,s.indexOf(`
`)>=0&&o++,n+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return a>60?e[0]+(t===""?"":t+`
 `)+" "+r.join(`,
  `)+" "+e[1]:e[0]+t+" "+r.join(", ")+" "+e[1]}function Rt(r){return Array.isArray(r)}h.isArray=Rt;function ar(r){return typeof r=="boolean"}h.isBoolean=ar;function P(r){return r===null}h.isNull=P;function nn(r){return r==null}h.isNullOrUndefined=nn;function Pt(r){return typeof r=="number"}h.isNumber=Pt;function B(r){return typeof r=="string"}h.isString=B;function an(r){return typeof r=="symbol"}h.isSymbol=an;function x(r){return r===void 0}h.isUndefined=x;function U(r){return E(r)&&ir(r)==="[object RegExp]"}h.isRegExp=U;function E(r){return typeof r=="object"&&r!==null}h.isObject=E;function nr(r){return E(r)&&ir(r)==="[object Date]"}h.isDate=nr;function $(r){return E(r)&&(ir(r)==="[object Error]"||r instanceof Error)}h.isError=$;function C(r){return typeof r=="function"}h.isFunction=C;function sn(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r>"u"}h.isPrimitive=sn;h.isBuffer=$t();function ir(r){return Object.prototype.toString.call(r)}function er(r){return r<10?"0"+r.toString(10):r.toString(10)}var mn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function fn(){var r=new Date,t=[er(r.getHours()),er(r.getMinutes()),er(r.getSeconds())].join(":");return[r.getDate(),mn[r.getMonth()],t].join(" ")}h.log=function(){console.log("%s - %s",fn(),h.format.apply(h,arguments))};h.inherits=Ct();h._extend=function(r,t){if(!t||!E(t))return r;for(var e=Object.keys(t),o=e.length;o--;)r[e[o]]=t[e[o]];return r};function Bt(r,t){return Object.prototype.hasOwnProperty.call(r,t)}});var V=r=>r.reduce((t,e)=>t.concat(Array.isArray(e)?V(e):e),[]),G=r=>ArrayBuffer.isView(r)&&!(r instanceof DataView),S=r=>r.reduce((t,e)=>t*e,1),W=r=>Array.isArray(r)||G(r)?[r.length].concat(W(r[0])):[],L=r=>[...r.slice(1).map((t,e)=>r.slice(e+1).reduce((o,a)=>o*a,1)),1],fr=r=>{let{constructor:{name:t="Float32Array"}={}}=r||{};switch(t){case"Int8Array":return"int8";case"Uint8Array":return"uint8";case"Int16Array":return"int16";case"Uint16Array":return"uint16";case"Int32Array":return"int32";case"Uint32Array":return"uint32";case"Uint8ClampedArray":return"uint8c";case"Float32Array":return"float32";case"Float64Array":return"float64";default:return"float64"}},g=r=>{switch(r){case"int8":return Int8Array;case"uint8":return Uint8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"uint8c":return Uint8ClampedArray;case"float32":return Float32Array;case"float64":return Float64Array;default:return Float64Array}};var i=(...r)=>new A(...r);var I=32,p=class{x;shape;shapem1;strides;backstrides;length;lengthm1;nd;ndm1;index;coords;pos;factors;constructor(t){this.x=i(t);let{shape:e,strides:o,length:a}=this.x;this.length=a,this.lengthm1=a-1,this.nd=e.length,this.ndm1=this.nd-1,this.shape=Array(I).fill(0),this.strides=Array(I).fill(0),this.shapem1=Array(I).fill(0),this.coords=Array(I).fill(0),this.backstrides=Array(I).fill(0),this.factors=Array(I).fill(0),this.nd!==0&&(this.factors[this.nd-1]=1);let n;for(n=0;n<this.nd;n+=1)this.shape[n]=e[n],this.shapem1[n]=e[n]-1,this.strides[n]=o[n],this.backstrides[n]=o[n]*this.shapem1[n],this.coords[n]=0,n>0&&(this.factors[this.ndm1-n]=this.factors[this.nd-n]*e[this.nd-n]);this.index=0,this.pos=0}done(){return this.index>this.lengthm1}current(){let t=this.done();return{value:t?void 0:this.pos,done:t}}next1d(){let{strides:t}=this;this.pos+=t[0],this.coords[0]+=1}next2d(){let{strides:t,shapem1:e,backstrides:o}=this;this.coords[1]<e[1]?(this.coords[1]+=1,this.pos+=t[1]):(this.coords[1]=0,this.coords[0]+=1,this.pos+=t[0]-o[1])}nextnd(){let{ndm1:t,shapem1:e,strides:o,backstrides:a}=this,n;for(n=t;n>=0;n-=1){if(this.coords[n]<e[n]){this.coords[n]+=1,this.pos+=o[n];break}this.coords[n]=0,this.pos-=a[n]}}next(){let t=this.current();this.index+=1;let{ndm1:e}=this;return e===0?this.next1d():e===1?this.next2d():this.nextnd(),t}[Symbol.iterator](){return this}},D=class{iters;shape;nd;length;lengthm1;numiter;index;pos;constructor(...t){this.iters=t.map(f=>new p(f)),this.numiter=t.length;let e,o;for(e=0,o=0;e<this.numiter;e+=1)o=Math.max(o,this.iters[e].x.shape.length);this.nd=o,this.shape=Array(o).fill(0);let a,n,s,m;for(e=0;e<o;e+=1)for(this.shape[e]=1,n=0;n<this.numiter;n+=1)if(a=this.iters[n],s=e+a.x.shape.length-o,s>=0){if(m=a.x.shape[s],m==1)continue;if(this.shape[e]==1)this.shape[e]=m;else if(this.shape[e]!==m)throw new Error("shape mismatch")}for(m=this.shape.reduce((f,c)=>f*c,1),this.length=m,this.lengthm1=m-1,e=0;e<this.numiter;e+=1)for(a=this.iters[e],a.nd=this.nd,a.ndm1=this.nd-1,a.length=m,a.lengthm1=m-1,o=a.x.shape.length,o!==0&&(a.factors[this.nd-1]=1),n=0;n<this.nd;n+=1)a.shape[n]=this.shape[n],a.shapem1[n]=this.shape[n]-1,s=n+o-this.nd,s<0||a.x.shape[s]!==this.shape[n]?a.strides[n]=0:a.strides[n]=a.x.strides[s],a.backstrides[n]=a.strides[n]*a.shapem1[n],n>0&&(a.factors[this.nd-n-1]=a.factors[this.nd-n]*this.shape[this.nd-n]);this.index=0,this.pos=Array(this.numiter).fill(0)}done(){return this.index>this.lengthm1}current(){let t=this.done();return{value:t?void 0:this.pos,done:t}}next(){let t=this.current();this.index+=1;let{numiter:e}=this,o,a;for(a=0;a<e;a+=1)o=this.iters[a],this.pos[a]=o.pos,o.next();return t}[Symbol.iterator](){return this}};var{abs:ee}=Math,oe=r=>i(r).abs();function pr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ee(r[e]);return this}var{acos:ne}=Math,ae=r=>i(r).acos();function cr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ne(r[e]);return this}var{acosh:ie}=Math,se=r=>i(r).acosh();function ur(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ie(r[e]);return this}var b;try{b=H("nblas")}catch{}var Y=b&&b.NoTrans,zn=b&&b.Trans;function yr(r,t,e,o,a,n,s){if(o.length/a!==t||n.length/s!==t)throw new Error("lengths do not match");switch(r){case"float64":return b.daxpy(t,e,o,a,n,s);case"float32":return b.saxpy(t,e,o,a,n,s);default:throw new Error("wrong dtype")}}function lr(r,t,e,o,a,n){if(e.length/o!==t||a.length/n!==t)throw new Error("lengths do not match");switch(r){case"float64":return b.ddot(t,e,o,a,n);case"float32":return b.sdot(t,e,o,a,n);default:throw new Error("wrong dtype")}}function hr(r,t,e,o){if(e.length/o!==t)throw new Error("lengths do not match");switch(r){case"float64":return b.idamax(t,e,o);case"float32":return b.isamax(t,e,o);default:throw new Error("wrong dtype")}}function dr(r,t,e,o,a,n,s,m,f,c,y,u,l,d){let{length:v}=m,{length:q}=c,{length:_}=l;if(t===b.NoTrans&&v!==f*o||t===b.Trans&&v!==f*n)throw new Error("lengths do not match");if(e===b.NoTrans&&q!==y*n||e===b.Trans&&q!==y*a)throw new Error("lengths do not match");if(_!==d*o)throw new Error("lengths do not match");switch(r){case"float64":return b.dgemm(t,e,o,a,n,s,m,f,c,y,u,l,d);case"float32":return b.sgemm(t,e,o,a,n,s,m,f,c,y,u,l,d);default:throw new Error("wrong dtype")}}function Ar(r,t,e,o){if(e.length/o!==t)throw new Error("lengths do not match");switch(r){case"float64":return b.dnrm2(t,e,o);case"float32":return b.snrm2(t,e,o);default:throw new Error("wrong dtype")}}function br(r,t,e,o,a){if(o.length/a!==t)throw new Error("lengths do not match");switch(r){case"float64":return b.dscal(t,e,o,a);case"float32":return b.sscal(t,e,o,a);default:throw new Error("wrong dtype")}}var me=(r,t,e=1)=>i(r).add(i(t),e);function Dr(r,t=1){let{data:e,length:o,strides:a,dtype:n}=this,{data:s,strides:m}=i(r);try{let f=m[m.length-1],c=a[a.length-1];if(f!==c)throw new Error("inc_x and inc_y must be equal");yr(n,o,t,s,f,e,c)}catch{let c=new D(this,r);for(let[y,u]of c)e[y]+=t*s[u]}return this}var{acos:fe}=Math,pe=(r,t)=>i(r).angle(i(t));function Nr(r){return fe(this.dot(i(r))/this.norm()/i(r).norm())}var{asin:ce}=Math,ue=r=>i(r).asin();function gr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ce(r[e]);return this}var{asinh:ye}=Math,le=r=>i(r).asinh();function xr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ye(r[e]);return this}var{atan:he}=Math,de=r=>i(r).atan();function wr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=he(r[e]);return this}var{atanh:Ae}=Math,be=r=>i(r).atanh();function kr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Ae(r[e]);return this}var N=(...r)=>new A(new Float64Array(r.reduce((t,e)=>t*e,1)),{shape:r}).fill(0);var Z=(r,t)=>i(r).augment(i(t));function Lr(r){let[t,e]=this.shape,[o,a]=i(r).shape,{data:n}=this,{data:s}=i(r);if(o===0||a===0)return this;if(t!==o)throw new Error("rows do not match");let m=N(t,e+a),{data:f}=m,c,y;for(c=0;c<t;c+=1)for(y=0;y<e;y+=1)f[c*(e+a)+y]=n[c*e+y];for(c=0;c<o;c+=1)for(y=0;y<a;y+=1)f[c*(e+a)+(y+e)]=s[c*a+y];return m}var De=(r,t,e)=>i(r).binOp(i(t),e);function Ir(r,t){let{data:e}=this,{data:o}=i(r),a=new D(this,r);for(let[n,s]of a)e[n]=t(e[n],o[s],n);return this}var{cbrt:Ne}=Math,ge=r=>i(r).cbrt();function Tr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Ne(r[e]);return this}var{ceil:xe}=Math,we=r=>i(r).ceil();function Er(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=xe(r[e]);return this}var ke=(r,...t)=>{i(r).check(...t)};function vr(...r){let{shape:t,length:e}=this;if(r.length===1){let[o]=r;if(o<0||o>e-1||!Number.isFinite(o))throw new Error("index out of bounds")}else if(!t.every((o,a)=>o>r[a]&&Number.isFinite(r[a])&&r[a]>=0))throw new Error("index out of bounds")}var Le=(r,t)=>i(r).combine(i(t));function Mr(r){if(this.shape.length!==1&&r.shape.length!==1)throw new Error("combine operation not permitted for multidimensional arrays");let{length:t,data:e}=this,{length:o,data:a}=r;if(o===0)return this;if(t===0)return this.data=new(g(r.dtype))(a),this.length=o,this.dtype=r.dtype,this;let n=t+o,s=new(g(this.dtype))(n);return s.set(e),s.set(a,t),this.data=s,this.length=n,this.shape=[n],this}var Ie=r=>i(r).copy();function jr(){let r=N(...this.shape),{data:t}=this,{data:e}=r,o=new D(this,r);for(let[a,n]of o)e[n]=t[a];return r}var{cos:Te}=Math,Ee=r=>i(r).cos();function qr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Te(r[e]);return this}var{cosh:ve}=Math,Me=r=>i(r).cosh();function _r(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ve(r[e]);return this}var je=(r,t)=>i(r).cross(i(t));function Sr(r){let{length:t}=this,{length:e}=r;if(t!==3||e!==3)throw new Error("vectors must have three components");let o=this.y*r.z-this.z*r.y,a=this.z*r.x-this.x*r.z,n=this.x*r.y-this.y*r.x;return this.x=o,this.y=a,this.z=n,this}var qe=r=>i(r).det();function zr(){this.square();let[r]=this.shape,[t,e]=this.copy().lu_factor(),{data:o}=t,a=1,n=1,s;for(s=0;s<r;s+=1)a*=o[s*r+s],s!==e[s]-1&&(n*=-1);return n*a}var _e=r=>i(r).diagonal();function Or(){this.square();let{length:r}=this,[t,e]=this.shape,o=Math.min(t,e);return this.reshape(r).slice(0,r,o+1)}var Se=(r,t)=>i(r).dot(i(t));function Fr(r){let{data:t,length:e,strides:o,dtype:a}=this,{data:n,strides:s}=r,m=0;try{let f=s[s.length-1],c=o[o.length-1];if(f!==c)throw new Error("inc_x and inc_y must be equal");m=lr(a,e,n,f,t,c)}catch{let c=new D(this,r);for(let[y,u]of c)m+=t[y]*n[u]}return m}var M=r=>{let t=new A(new Float64Array(r*r),{shape:[r,r]}),{data:e}=t,o;for(o=0;o<r;o+=1)e[o*r+o]=1;return t};var j;try{j=H("nlapack")}catch{}var z=(r,t,e,o,a,n,s)=>{let[m]=r.shape,{data:f}=r,c=f[o*m+a],y=1/(t+e);f[o*m+a]=c-e*(f[n*m+s]+y*c),f[n*m+s]+=e*(c-y*f[n*m+s])},ze=r=>i(r).eig();function Ur(){this.square();let[r]=this.shape;try{["float32","float64"].includes(this.dtype)||(this.dtype="float32",this.data=g(this.dtype).from(this.data));let t=j.NoEigenvector,e=j.Eigenvector,o=N(r),a=N(r),n=N(r,r),s=N(r,r),{data:m}=this,{data:f}=o,{data:c}=a,{data:y}=n,{data:u}=s;return this.dtype==="float64"&&j.dgeev(t,e,r,m,r,f,c,y,r,u,r),this.dtype==="float32"&&j.sgeev(t,e,r,m,r,f,c,y,r,u,r),[o,s]}catch{let{data:e}=this,o=M(r),a=0,n=0,s=0,m=0,f=0;do{for(n=0;n<r;n+=1)for(s=n+1;s<r;s+=1)Math.abs(e[n*r+s])>=a&&(a=Math.abs(e[n*r+s]),m=n,f=s);let c;if(Math.abs(e[m*r+f])<Math.abs(e[f*r+f])*1e-36)c=e[m*r+f]/e[f*r+f];else{let d=e[f*r+f]/2*e[m*r+f];c=1/(Math.abs(d)+Math.sqrt(d*d+1))}let y=1/Math.sqrt(c*c+1),u=c*y,l=e[m*r+f];for(e[m*r+f]=0,e[m*r+m]-=c*l,e[f*r+f]+=c*l,n=0;n<m;n+=1)z(this,y,u,n,m,n,f);for(n=m+1;n<f;n+=1)z(this,y,u,m,n,n,f);for(n=f+1;n<r;n+=1)z(this,y,u,m,n,f,n);for(n=0;n<r;n+=1)z(o,y,u,n,m,n,f)}while(a>=1e-9);return[this.diagonal(),o]}}var Oe=(r,t,e=1e-6)=>i(r).equals(i(t),e);function $r(r,t=1e-6){let{data:e}=this,{data:o}=r,a=new D(this,r);for(let[n,s]of a)if(Math.abs(e[n]-o[s])>t)return!1;return!0}var Fe=(r,t)=>{i(r).equidimensional(i(t))};function Cr(r){let{shape:t}=this,{shape:e}=r;if(!t.every((o,a)=>o===e[a]))throw new Error(`shapes ${t} and ${e} do not match`)}var Ue=(r,t)=>{i(r).equilateral(i(t))};function Rr(r){let{length:t}=this,{length:e}=r;if(t!==e)throw new Error(`lengths ${t} and ${e} do not match`)}var{exp:$e}=Math,Ce=r=>i(r).exp();function Pr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=$e(r[e]);return this}var{expm1:Re}=Math,Pe=r=>i(r).expm1();function Br(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Re(r[e]);return this}var Be=(r,t=0)=>i(r).fill(t);function Hr(r=0){let{data:t}=this,e=new p(this);for(let o of e)t[o]=r instanceof Function?r(o):r;return this}var{floor:He}=Math,Je=r=>i(r).floor();function Jr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=He(r[e]);return this}var Ve=(r,t)=>{r.forEach(t)};function Vr(r){let{data:t}=this,e=new p(this);for(let o of e)r.call(this,t[o],o,t)}var{fround:Ge}=Math,We=r=>i(r).fround();function Gr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Ge(r[e]);return this}var Ye=r=>i(r).gauss();function Wr(){let{shape:[r,t],data:e}=this,o=0,a,n,s,m,f;for(s=0;s<r;s+=1){if(t<=o)return this;for(m=s;e[m*t+o]===0;)if(m+=1,r===m&&(m=s,o+=1,t===o))return this;if(s!==m&&this.swap(s,m),n=e[s*t+o],n!==0)for(f=0;f<t;f+=1)e[s*t+f]/=n;for(m=0;m<r;m+=1)if(a=e[m*t+o],m!==s)for(f=0;f<t;f+=1)e[m*t+f]-=e[s*t+f]*a;o+=1}for(s=0;s<r;s+=1){for(n=0,m=0;m<t;m+=1)n===0&&(n=e[s*t+m]);if(n!==0)for(f=0;f<t;f+=1)e[s*t+f]/=n}return this}var Ze=(r,...t)=>i(r).get(...t);function Yr(...r){this.check(...r);let{data:t,shape:e}=this,{length:o}=e,a=r[o-1],n,s;for(n=0;n<o-1;n+=1){let m=1;for(s=n+1;s<o;s+=1)m*=e[s];a+=r[n]*m}return t[a]}var k;try{k=H("nlapack")}catch{}function O(r,t,e,o,a,n){if(o.length!==t*e)throw new Error("lengths do not match");switch(r){case"float64":return k.dgetrf(t,e,o,a,n);case"float32":return k.sgetrf(t,e,o,a,n);default:throw new Error("wrong dtype")}}function Zr(r,t,e,o,a){if(e.length!==t*t)throw new Error("lengths do not match");switch(r){case"float64":return k.dgetri(t,e,o,a);case"float32":return k.sgetri(t,e,o,a);default:throw new Error("wrong dtype")}}function Xr(r,t,e,o,a,n,s,m){if(o.length!==a*t||s.length!==m*e)throw new Error("lengths do not match");switch(r){case"float64":return k.dgesv(t,e,o,a,n,s,m);case"float32":return k.sgesv(t,e,o,a,n,s,m);default:throw new Error("wrong dtype")}}var Xe=r=>i(r).inv();function Kr(){this.square();let{shape:[r],dtype:t}=this;try{let{data:e}=this,o=new Int32Array(r);return O(t,r,r,e,r,o),Zr(t,r,e,r,o),this}catch{let o=M(r),a=Z(this,o).gauss(),n=N(r,r),s=N(r,r),{data:m}=a,{data:f}=n,{data:c}=s,y=new p(a),[u,l]=y.coords;for(let d of y)l<r?f[u*r+l]=m[d]:c[u*r+(l-r)]=m[d],[u,l]=y.coords;if(!n.equals(o))throw new Error("matrix is not invertible");return s}}var{log:Ke}=Math,Qe=r=>i(r).log();function Qr(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Ke(r[e]);return this}var{log10:ro}=Math,to=r=>i(r).log10();function rt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=ro(r[e]);return this}var{log1p:eo}=Math,oo=r=>i(r).log1p();function tt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=eo(r[e]);return this}var{log2:no}=Math,ao=r=>i(r).log2();function et(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=no(r[e]);return this}var io=r=>i(r).lu();function ot(){let[r,t]=this.copy().lu_factor(),e=r.copy(),o=r.copy(),{data:a}=e,{data:n}=o,s=new p(r),[m,f]=s.coords;for(let c of s)f<m?n[c]=0:a[c]=m===f?1:0,[m,f]=s.coords;return[e,o,t]}var so=r=>i(r).lu_factor();function nt(){let{data:r,shape:[t],dtype:e}=this,o=new Int32Array(t);try{O(e,t,t,r,t,o)}catch{let n,s,m,f,c,y,u;for(u=0;u<t;u+=1){for(f=u,n=Math.abs(r[u*t+u]),y=u+1;y<t;y+=1)s=Math.abs(r[y*t+u]),n<s&&(n=s,f=y);for(o[u]=f+1,f!==u&&this.swap(u,f),m=r[u*t+u],c=u+1;c<t;c+=1)r[c*t+u]/=m;for(c=u+1;c<t;c+=1){for(y=u+1;y<t-1;y+=2)r[c*t+y]-=r[c*t+u]*r[u*t+y],r[c*t+y+1]-=r[c*t+u]*r[u*t+y+1];y===t-1&&(r[c*t+y]-=r[c*t+u]*r[u*t+y])}}}return[this,o]}var mo=(r,t)=>i(r).map(t);function at(r){let{data:t}=this,e=new p(this),o=r.bind(this),a=this.copy(),{data:n}=a;for(let s of e)n[s]=o(t[s],s,t);return a}var fo=r=>i(r).max();function it(){let{data:r,length:t,strides:e,dtype:o}=this,a=Number.NEGATIVE_INFINITY;try{let n=e[e.length-1];a=r[hr(o,t,r,n)]}catch{let s=new p(this);for(let m of s){let f=r[m];a<f&&(a=f)}}return a}var po=r=>i(r).mean();function st(){let{data:r,length:t}=this,e=new p(this),o=0;for(let a of e)o+=r[a];return o/t}var co=r=>i(r).min();function mt(){let{data:r}=this,t=new p(this),e=Number.POSITIVE_INFINITY;for(let o of t){let a=r[o];e>a&&(e=a)}return e}var K=(r,t)=>new A(new Float64Array(r*t),{shape:[r,t]});var uo=(r,t)=>i(r).multiply(i(t));function ft(r){let{shape:[t,e],data:o,dtype:a}=this.copy(),{shape:[n,s],data:m}=r.copy();if(e!==n)throw new Error("sizes do not match");let f=K(t,s),{data:c}=f;try{dr(a,Y,Y,t,s,e,1,o,e,m,s,0,c,s)}catch{let u=new p(f),l,[d,v]=u.coords;for(let q of u){let _=0;for(l=0;l<e;l+=1)_+=o[d*e+l]*m[l*s+v];c[q]=_,[d,v]=u.coords}}return f}var{sqrt:yo}=Math,lo=r=>i(r).norm();function pt(){let{data:r,length:t,strides:e,dtype:o}=this,a=0;try{let n=e[e.length-1];a=Ar(o,t,r,n)}catch{a=yo(this.dot(this))}return a}var ho=r=>i(r).normalize();function ct(){return this.scale(1/this.norm())}var{pow:Ao}=Math,bo=(r,t)=>i(r).pow(t);function ut(r){let{data:t}=this,e=new p(this);for(let o of e)t[o]=Ao(t[o],r);return this}var Do=r=>i(r).prod();function yt(){let{data:r}=this,t=new p(this),e=1;for(let o of t)e*=r[o];return e}var No=(r,t)=>i(r).product(i(t));function lt(r){let{data:t}=this,{data:e}=r,o=new D(this,r);for(let[a,n]of o)t[a]*=e[n];return this}var go=(r,t)=>i(r).project(i(t));function ht(r){return r.scale(this.dot(r)/r.dot(r))}var xo=(r,t)=>i(r).push(t);function dt(r){if(this.shape.length!==1)throw new Error("push operation not permitted for multidimensional arrays");let{data:t,length:e}=this,o=e+1,a=new(g(this.dtype))(o);return a.set(t),a[e]=r,this.data=a,this.length=o,this.shape=[o],this}var wo=(r,t=1e-6)=>i(r).rank(t);function At(r=1e-6){let{data:t}=this.copy().gauss(),e=new p(this),o=0,[a,n]=e.coords;for(let s of e)o<=a&&n>=a&&Math.abs(t[s])>r&&(o+=1),[a,n]=e.coords;return o}var ko=r=>i(r).reciprocal();function bt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=1/r[e];return this}var Lo=(r,t,e)=>i(r).reduce(t,e);function Dt(r,t){let{data:e,length:o}=this;if(o===0&&typeof t>"u")throw new Error("Reduce of empty array with no initial value.");let a=new p(this),n=r.bind(this),s;typeof t>"u"?(s=e[0],a.next()):s=t;for(let m of a)s=n(s,e[m],m,e);return s}var Io=(r,...t)=>i(r).reshape(...t);function Nt(...r){let{length:t}=this;if(r.reduce((e,o)=>e*o,1)!==t)throw new Error(`shape ${r} does not match length ${t}`);return this.shape=r,this.strides=L(r),this}var{round:To}=Math,Eo=r=>i(r).round();function gt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=To(r[e]);return this}var vo=(r,t,e,o=1)=>i(r).row_add(t,e,o);function xt(r,t,e=1){this.check(r,0),this.check(t,0);let[,o]=this.shape,{data:a}=this,n;for(n=0;n<o;n+=1)a[r*o+n]+=a[t*o+n]*e;return this}var Mo=(r,t)=>i(r).scale(t);function wt(r){let{data:t,length:e,strides:o,dtype:a}=this;try{let n=o[o.length-1];br(a,e,r,t,n)}catch{let s=new p(this);for(let m of s)t[m]*=r}return this}var jo=(r,...t)=>{r.set(...t)};function kt(...r){let t=r.slice(0,-1),e=r[r.length-1];this.check(...t);let{shape:o}=this,a=t[t.length-1],n;for(n=0;n<t.length-1;n+=1)a+=t[n]*o[n+1];this.data[a]=e}var{sign:qo}=Math,_o=r=>i(r).sign();function Lt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=qo(r[e]);return this}var{sin:So}=Math,zo=r=>i(r).sin();function It(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=So(r[e]);return this}var{sinh:Oo}=Math,Fo=r=>i(r).sinh();function Tt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Oo(r[e]);return this}var Uo=(r,t,e,o)=>i(r).slice(t,e,o);function Et(r=0,t=this.shape[0],e=1){let{data:o,shape:a}=this,n=a.length;if(r<0||t<0)return this.slice(r<0?a[a.length-1]+r:r,t<0?a[a.length-1]+t:t);if(r>t)return this.slice(t,r,e);if(e<=0)throw new Error("step argument has to be a positive integer");let s=[Math.ceil((t-r)/Math.abs(e)),...a.slice(1)],m=S(s),f=L(s),c=n>1?o.subarray(r*s[s.length-1],t*s[s.length-1]):o.subarray(r,t);return f[0]*=e,new A(c,{shape:s,length:m,strides:f})}var $o=(r,t)=>i(r).solve(i(t));function vt(r){let{data:t,dtype:e}=this,{data:o,shape:[a,n]}=r;try{let s=new Int32Array(a);Xr(e,a,n,t,a,s,o,n)}catch{let[m,f]=this.lu_factor(),{data:c}=m,{data:y}=r,u,l,d;for(u=0;u<f.length;u+=1)u!==f[u]-1&&r.swap(u,f[u]-1);for(d=0;d<n;d+=1){for(u=0;u<a;u+=1)for(l=0;l<u;l+=1)y[u*n+d]-=c[u*a+l]*y[l*n+d];for(u=a-1;u>=0;u-=1){for(l=u+1;l<a;l+=1)y[u*n+d]-=c[u*a+l]*y[l*n+d];y[u*n+d]/=c[u*a+u]}}}return r}var{sqrt:Co}=Math,Ro=r=>i(r).sqrt();function Mt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Co(r[e]);return this}var Po=r=>{i(r).square()};function jt(){let{length:r}=this.shape,[t,e]=this.shape;if(r!==2||t!==e)throw new Error("matrix is not square")}var Bo=(r,t)=>i(r).subtract(i(t));function qt(r){return this.add(r,-1)}var Ho=r=>i(r).sum();function _t(){let{data:r}=this,t=new p(this),e=0;for(let o of t)e+=r[o];return e}var Jo=(r,t,e)=>i(r).swap(t,e);function St(r,t){this.check(r,0),this.check(t,0);let{data:e}=this,[,o]=this.shape,a=e.slice(r*o,(r+1)*o);return e.copyWithin(r*o,t*o,(t+1)*o),e.set(a,t*o),this}var{tan:Vo}=Math,Go=r=>i(r).tan();function zt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Vo(r[e]);return this}var{tanh:Wo}=Math,Yo=r=>i(r).tanh();function Ot(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=Wo(r[e]);return this}var Zo=r=>i(r).toArray();function Ft(r=0,t=0){let{data:e,shape:o,strides:a}=this,{length:n}=o;if(t>=n)return e[r];let s=o[t],m=a[t],f=[];for(let c=0;c<s;c++){let y=this.toArray(r,t+1);if(y===null)return null;f[c]=y,r+=m}return f}var Jt=te(Ht());var pn=r=>i(r).toString();function sr(){return`array(${(0,Jt.inspect)(this.toArray(),{depth:10,breakLength:40})}, dtype=${this.dtype})`}var cn=r=>i(r).trace();function Vt(){let[r,t]=this.shape,{data:e}=this,o=Math.min(r,t),a=0,n;for(n=0;n<o;n+=1)a+=e[n*t+n];return a}var un=r=>i(r).transpose();function Gt(){if(this.shape.length<2)return this;let r=this.shape[0];return this.shape[0]=this.shape[1],this.shape[1]=r,r=this.strides[0],this.strides[0]=this.strides[1],this.strides[1]=r,this}var{trunc:yn}=Math,ln=r=>i(r).trunc();function Wt(){let{data:r}=this,t=new p(this);for(let e of t)r[e]=yn(r[e]);return this}var hn=r=>{if(r<0)throw new Error("invalid n");let t=new Float64Array(r*r),e=new A(t,{shape:[r,r]}),o=new p(e),[a,n]=o.coords;for(let s of o){let m=r-a-1,f=r-n-1;t[s]=(n+m*2+1)%r*r+(f+m*2+1)%r+1,[a,n]=o.coords}return e};var dn=(...r)=>new A(new Float64Array(r.reduce((t,e)=>t*e,1)),{shape:r}).fill(1);var An=(...r)=>new A(new Float64Array(r.reduce((t,e)=>t*e,1)),{shape:r}).map(()=>Math.random());var bn=(...r)=>{let t=Float64Array,e=!1,o,a,n;switch(r.length){case 2:n=r.pop(),a=1,o=r.pop();break;case 3:n=r.pop(),a=r.pop(),o=r.pop();break;default:throw new Error("invalid range")}if(n-o<0){let c=n;n=o,o=c,e=!0}if(a>n-o)throw new Error("invalid range");let s=new t(Math.ceil((n-o)/a)),m=o,f=0;if(e)for(;m<n;m+=a,f+=1)s[f]=n-m+o;else for(;m<n;m+=a,f+=1)s[f]=m;return new A(s)};var Dn=Symbol.for("nodejs.util.inspect.custom"),A=class{data=new Float64Array(0);dtype="float64";length=0;shape=[0];strides=[0];[Dn]=sr;abs=pr;acos=cr;acosh=ur;add=Dr;angle=Nr;asin=gr;asinh=xr;atan=wr;atanh=kr;augment=Lr;binOp=Ir;cbrt=Tr;ceil=Er;check=vr;combine=Mr;copy=jr;cos=qr;cosh=_r;cross=Sr;det=zr;diagonal=Or;dot=Fr;eig=Ur;equals=$r;equidimensional=Cr;equilateral=Rr;exp=Pr;expm1=Br;fill=Hr;floor=Jr;forEach=Vr;fround=Gr;gauss=Wr;get=Yr;inv=Kr;log=Qr;log10=rt;log1p=tt;log2=et;lu=ot;lu_factor=nt;map=at;max=it;mean=st;min=mt;multiply=ft;norm=pt;normalize=ct;pow=ut;prod=yt;product=lt;project=ht;push=dt;rank=At;reciprocal=bt;reduce=Dt;reshape=Nt;round=gt;row_add=xt;scale=wt;set=kt;sign=Lt;sin=It;sinh=Tt;slice=Et;solve=vt;sqrt=Mt;square=jt;subtract=qt;sum=_t;swap=St;tan=zt;tanh=Ot;toArray=Ft;toString=sr;trace=Vt;transpose=Gt;trunc=Wt;constructor(t,e){if(!t)return;if(t instanceof A)return t;if(t instanceof p){if(!e||!e.dtype)throw new Error("dtype is missing");t.shape&&(e.shape=t.shape);let m=t.length;t=new(g(e.dtype))(m)}let{shape:o=W(t),length:a=S(o),strides:n=L(o),dtype:s=fr(t)}=e||{};this.data=G(t)?t:new(g(s))(V(t)),this.shape=o,this.length=a,this.dtype=s,this.strides=n}get x(){return this.get(0)}set x(t){this.set(0,t)}get y(){return this.get(1)}set y(t){this.set(1,t)}get z(){return this.get(2)}set z(t){this.set(2,t)}get w(){return this.get(3)}set w(t){this.set(3,t)}get T(){return this.copy().transpose()}};try{window.v=A}catch{}export{A as NDArray,p as NDIter,D as NDMultiIter,I as V_MAXDIMS,oe as abs,ae as acos,se as acosh,me as add,pe as angle,i as array,ue as asin,le as asinh,de as atan,be as atanh,Z as augment,De as binOp,ge as cbrt,we as ceil,ke as check,Le as combine,Ie as copy,Ee as cos,Me as cosh,je as cross,qe as det,_e as diagonal,Se as dot,ze as eig,Oe as equals,Fe as equidimensional,Ue as equilateral,Ce as exp,Pe as expm1,M as eye,Be as fill,Je as floor,Ve as forEach,We as fround,Ye as gauss,Ze as get,Xe as inv,Qe as log,to as log10,oo as log1p,ao as log2,io as lu,so as lu_factor,hn as magic,mo as map,K as matrix,fo as max,po as mean,co as min,uo as multiply,lo as norm,ho as normalize,dn as ones,bo as pow,Do as prod,No as product,go as project,xo as push,An as random,bn as range,wo as rank,ko as reciprocal,Lo as reduce,Io as reshape,Eo as round,vo as row_add,Mo as scale,jo as set,_o as sign,zo as sin,Fo as sinh,Uo as slice,$o as solve,Ro as sqrt,Po as square,Bo as subtract,Ho as sum,Jo as swap,Go as tan,Yo as tanh,Zo as toArray,pn as toString,cn as trace,un as transpose,ln as trunc,N as zeros};
//# sourceMappingURL=index.esm.js.map
